@using FramasVietNam.Common;
@{
    var lstDepartment = (List<FramasVietNam.Models.HumanResource.MaBoPhan>)ViewBag.AllDept;
    var objView = (FramasVietNam.Models.Menu.FSComputer)ViewBag.objView;
     DateTime dtDateMark = mFunction.ToDateTime(ViewBag.dtDateSearch);
}

<div class="modal-content">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">@Language.label("View")</h4>
    </div>
    <div class="modal-body">
        <div class="col-md-3">
            <div class="form-group">
                @Language.label("Department")<code>(*)</code>
                <select class="form-control select2" style="width: 100%;" id="select_DeptId" data-placeholder="Select a department" disabled>
                    @if (objView != null)
                    {
                        <option selected value="@objView.DepartmentId"> @objView.DepartmentName</option>
                    }
                </select>
            </div>
        </div>
        <div class="col-md-3">
            <div class="form-group">
                @Language.label("User")<code>(*)</code>
                <select class="form-control select2" style="width: 100%;" id="select_Userid" data-placeholder="select a user" disabled>
                    @if (objView != null)
                    {
                        <option selected value="@objView.EmployeeId">@objView.EmployeeId _ @objView.EmployeeName</option>
                    }
                </select>
            </div>
        </div>
        <div class="col-md-2">
            @Language.label("Date") <code>(*)</code>
                <input type='text' name="dtDateAdd" id='dtDateAdd' class="form-control" value="@(ViewBag.objView.DateMark.ToString("dd/MM/yyyy"))" />
        </div>
        <table class="ComputerAdd">
            <tr>
                <th style="width:27px;">Num</th>
                <th style="width:600px;">Description</th>
                <th>Mark in first time	</th>
                <th>Factor</th>
                <th>Note</th>
            </tr>
            <tr>
                <td>1</td>
                <td>
                    "Máy tính có sạch sẽ, được bảo quản tốt và dán tem quản lý thiết bị không?
                    <p style="color: dodgerblue;">Is PC kept clean, in good condition and labled with "PC coding" label?"</p>

                </td>
                <td>
                    @objView.Mark1
                </td>
                <td>
                    @objView.Factor1
                </td>
                <td>
                    @objView.Note1
                </td>
            </tr>
            <tr>
                <td>2</td>
                <td>
                    "Màn hình desktop chỉ chứa các shortcut và chúng được sàng lọc và sắp xếp hợp lý không? (Không lưu file trên màn hình desktop)
                    <p style="color: dodgerblue;">
                        Is desktop screen is free of files and folders, just only shortcut stored and shortcuts are sorted and
                        set in order? (No file saved in desktop)
                    </p>
                </td>
                <td>
                    @objView.Mark2
                </td>
                <td>
                    @objView.Factor2
                </td>
                <td>
                    @objView.Note2
                </td>
            </tr>
            <tr>
                <td>3</td>
                <td>
                    "Có lịch dọn rác máy tính và có xóa bỏ các tập tin, thư mục, email, chương trình,... cũ hoặc không cần thiết theo như lịch không?
                    Có chống phân mảng máy tính định kì không?
                    <p style="color: dodgerblue;">
                        Is there cleaning schedule for your PC? do you delete files, folders, emails and SWs that are no longer needed according to your schedule?
                        Do you defragment your PC periodically?"
                    </p>
                </td>
                <td>
                    @objView.Mark3
                </td>
                <td>
                    @objView.Factor3
                </td>
                <td>
                    @objView.Note3
                </td>
            </tr>
            <tr>
                <td>4</td>
                <td>
                    "Có đặt tên tập tin, thư mục theo đúng quy định của công ty không? (những file chỉ tạo 1 lần duy nhất; file nhạc, phim,…;
                    những thư mục không quan trọng thì không cần đặt tên theo qui định).
                    <p style="color: dodgerblue;">Are files, folders named follow company's rules? (exception: files that create 1 time or don't need to be distingushed with the others; music, video, and folders are not important)".</p>
                </td>
                <td>
                    @objView.Mark4
                </td>
                <td>
                    @objView.Factor4
                </td>
                <td>
                    @objView.Note4
                </td>
            </tr>
            <tr>
                <td>5</td>
                <td>
                    "Các tập tin, thư mục có được lưu để dễ tim kiếm trong vòng 30 giây?
                    <p style="color: dodgerblue;">Are files, folders saved in a way that can be searched in 30sec?"</p>
                </td>
                <td>
                    @objView.Mark5
                </td>
                <td>
                    @objView.Factor5
                </td>
                <td>
                    @objView.Note5
                </td>
            </tr>
            <tr>
                <td>6</td>
                <td>
                    "Tất cả các tập tin, thư mục và mailbox có được hoàn toàn lưu và theo tác kết nối với server không? (Trừ những file tạm...)
                    <p style="color: dodgerblue;">Are all files, folders, mailbox fully stored in company server? (excluded temporally files)"</p>
                </td>
                <td>
                    @objView.Mark6
                </td>
                <td>
                    @objView.Factor6
                </td>
                <td>
                    @objView.Note6
                </td>
            </tr>
            <tr>
                <td>7</td>
                <td>
                    "Các tập tin thuộc danh mục tài liệu ISO có được mã hóa theo qui định không?
                    <p style="color: dodgerblue;">Are ISO files coded follow ISO rules?"</p>
                </td>
                <td>
                    @objView.Mark7
                </td>
                <td>
                    @objView.Factor7
                </td>
                <td>
                    @objView.Note7
                </td>
            </tr>
            <tr>
                <td>8</td>
                <td>
                    "Các tập tin được tạo và lưu trong máy có liên quan đến công việc được giao không? (những file này được gọi là file lặp lại và thường được tạo ra hàng ngày, hàng tuần hoặc hàng tháng)
                    <p style="color: dodgerblue;">Is there job description for each job-related file? (These files are created repeatly daily/weekly or monthly)"</p>
                </td>
                <td>
                    @objView.Mark8
                </td>
                <td>
                    @objView.Factor8
                </td>
                <td>
                    @objView.Note8
                </td>
            </tr>
            <tr>
                <td>9</td>
                <td>
                    "Có tài liệu hướng dẫn sử dụng và diễn giải cách thức hoạt động cho các chương trình, tập tin tự xây dựng để phục vụ công việc không?
                    <p style="color: dodgerblue;">Is there written user's guidelines / SW descriptions for self-programmed SW or files?" NULL</p>
                </td>
                <td>
                    @objView.Mark9
                </td>
                <td>
                    @objView.Factor9
                </td>
                <td>
                    @objView.Note9
                </td>
            </tr>
            <tr>
                <td>10</td>
                <td>
                    "Không sử dụng bất kỳ phần mềm, tài liệu, nhạc, phim, ảnh vi phạm bản quyền nào. (Các file nhạc, phim không có bản quyền không được lưu trên public folders)
                    <p style="color: dodgerblue;">There is no softwares, documents, musics, videos, pictures violated the copyrights in your PC. (not allow no copyright musics, videos in public foldes)"</p>
                </td>
                <td>
                    @objView.Mark10
                </td>
                <td>
                    @objView.Factor10
                </td>
                <td>
                    @objView.Note10
                </td>
            </tr>
            <tr>
                <td>11</td>
                <td>
                    "Máy tính có được cài đặt chương trình chống virus và spyware không?
                    <p style="color: dodgerblue;">Is your PC protected by anti-virus and anti-spyware SW?"</p>
                </td>
                <td>
                    @objView.Mark11
                </td>
                <td>
                    @objView.Factor11
                </td>
                <td>
                    @objView.Note11
                </td>
            </tr>
            <tr>
                <td>12</td>
                <td>
                    "Có đặt mục tiêu cải thiện cho lần chấm kế tiếp không và có cải thiện không?
                    <p style="color: dodgerblue;">Are you actively involved in 5S scan and are you willing to improve by showing your problems and promise to improve?"</p>
                </td>
                <td>
                    @objView.Mark12
                </td>
                <td>
                    @objView.Factor12
                </td>
                <td>
                    @objView.Note12
                </td>
            </tr>
            <tr>
                <td>13</td>
                <td>
                    "Cá nhân hoá bộ phần mêm Microsoft Office bằng cách thêm họ tên , phòng bàn và số điện thoại bàn
                    <p style="color: dodgerblue;">Personalize your copy of Microsoft Office by edit User name with your full name, department and extension phone number"</p>
                </td>
                <td>
                    @objView.Mark13
                </td>
                <td>
                    @objView.Factor13
                </td>
                <td>
                    @objView.Note13
                </td>
            </tr>
            <tr>
                <td>14</td>
                <td>
                    "Chữ ký trong outlook phai đặt theo quy định công ty
                    <p style="color: dodgerblue;">Standard signature in Outlook"</p>
                </td>
                <td>
                    @objView.Mark14
                </td>
                <td>
                    @objView.Factor14
                </td>
                <td>
                    @objView.Note14
                </td>
            </tr>
            <tr>
                <td>15</td>
                <td>
                    "Tổng điểm có thể đạt được
                    <p style="color: dodgerblue;">Reachable Score"</p>
                </td>
                <td>
                    @objView.TotalScore
                </td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td></td>
                <td>
                    <b>Resutls in %:</b>
                </td>
                <td>
                    @objView.TotalPercent
                </td>
                <td></td>
                <td></td>
            </tr>

        </table>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
    </div>
</div>


<script type="text/javascript">
    $(function () {
        //Call select2
        $('.select2').select2();

        $('#select_DeptId.select2').on('select2:select', function () {
            var data = $("#select_DeptId.select2 option:selected").val();
            $("#select_Userid.select2").html("");
            $.ajax({
                type: "POST",
                url: "@(Url.Action("UserByDeptId", "FSComputer"))",
                content: "application/json; charset =utf-8",
                dataType: "json",
                data: {deptId:data},
                success: function (data) {
                    console.log(data);
                    $.each(data, function (key, value) {
                        $('#select_Userid.select2').append(
                            '<option value="' + value["MaSoNhanVien"] + '">' + value["Ho"] + " " + value["Ten"] + '</option>'
                     );
                    });
                  },
                error: function (xhr, textStatus, errorThrown) {
                   alert("@Language.label("OopsSomethingWentWrong")");
                    return false;
                }
            });
         });
    });

</script>



